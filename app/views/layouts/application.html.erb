<!DOCTYPE html>
<html class="h-full dark">
  <head>
    <title><%= content_for(:title) || "No iLLusion SMM" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body class="bg-gray-50 dark:bg-gray-900 min-h-screen transition-colors duration-200">
    <header class="bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700 transition-colors duration-200">
      <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <!-- Logo / Brand -->
          <%= link_to root_path, class: "flex items-center space-x-2 hover:opacity-80 transition-opacity" do %>
            <span class="text-2xl font-bold text-gray-900 dark:text-white">No iLLusion</span>
            <span class="text-sm font-medium text-gray-600 dark:text-gray-300">SMM</span>
          <% end %>

          <!-- Desktop Navigation -->
          <div class="hidden md:flex items-center space-x-6">
            <% if user_signed_in? %>
              <%= link_to "Dashboard", dashboard_path, 
                          class: "text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md text-sm font-medium transition-colors" %>
              <%= link_to "Posts", posts_path, 
                          class: "text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md text-sm font-medium transition-colors" %>
              <% if AiConfigService.can_access_feature?(current_user, :can_generate_linkedin_bio) %>
                <%= link_to "Resume", resume_path, 
                            class: "text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md text-sm font-medium transition-colors" %>
              <% end %>
              <%= link_to "Profile", edit_user_profile_path, 
                          class: "text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md text-sm font-medium transition-colors" %>
              <%= link_to "Pricing", pricing_path, 
                          class: "text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md text-sm font-medium transition-colors" %>
            <% else %>
              <%= link_to "Pricing", pricing_path, 
                          class: "text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md text-sm font-medium transition-colors" %>
            <% end %>
            
            <!-- Theme Toggle - Disabled for dark mode only -->
            <!-- <button data-theme-toggle
                    class="p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-200">
              <span>
                <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
              </span>
            </button> -->

            <% if user_signed_in? %>
              <div class="flex items-center space-x-4 pl-4 border-l border-gray-200 dark:border-gray-600">
                <span class="text-sm text-gray-700 dark:text-gray-300">
                  Welcome, <span class="font-medium"><%= current_user.name&.split(' ')&.first || current_user.email %></span>
                </span>
                <%= button_to "Logout", destroy_user_session_path, method: :delete, 
                            class: "text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400 text-sm font-medium transition-colors border-0 bg-transparent p-0",
                            form: { style: "display: inline;" } %>
              </div>
            <% else %>
              <div class="flex items-center space-x-3">
                <%= link_to "Sign In", auth0_login_url('login'), 
                            class: "text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md text-sm font-medium transition-colors" %>
                <%= link_to "Get Started", auth0_login_url('signup'), 
                            class: "bg-blue-600 dark:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors shadow-sm" %>
              </div>
            <% end %>
          </div>

          <!-- Mobile Navigation - Right Side -->
          <div class="md:hidden flex items-center space-x-1">
            <!-- Theme Toggle for mobile - Disabled for dark mode only -->
            <!-- <button data-theme-toggle
                    class="p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
              <span>
                <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
              </span>
            </button> -->
            
            <% if user_signed_in? %>
              <!-- Mobile Menu Dropdown -->
              <div class="relative" data-controller="dropdown">
                <button type="button" data-action="click->dropdown#toggle"
                        class="p-2 rounded-lg text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                  <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                  </svg>
                </button>
                
                <!-- Dropdown Menu -->
                <div data-dropdown-target="menu"
                     class="hidden absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 z-50">
                  <div class="py-1">
                    <%= link_to dashboard_path, 
                                class: "flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" do %>
                      <svg class="h-4 w-4 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2 2z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v3H8V5z" />
                      </svg>
                      Dashboard
                    <% end %>
                    
                    <%= link_to posts_path, 
                                class: "flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" do %>
                      <svg class="h-4 w-4 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                      </svg>
                      Posts
                    <% end %>
                    
                    <%= link_to edit_user_profile_path, 
                                class: "flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" do %>
                      <svg class="h-4 w-4 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                      </svg>
                      Profile
                    <% end %>
                    
                    <div class="border-t border-gray-200 dark:border-gray-600"></div>
                    
                    <%= button_to destroy_user_session_path, method: :delete, 
                                  class: "flex items-center px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors w-full text-left border-0 bg-transparent",
                                  form: { style: "display: inline;" } do %>
                      <svg class="h-4 w-4 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                      </svg>
                      Logout
                    <% end %>
                  </div>
                </div>
              </div>
            <% else %>
              <%= link_to "Sign In", auth0_login_url('login'), 
                          class: "text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 text-sm font-medium transition-colors" %>
            <% end %>
          </div>
        </div>
      </nav>
    </header>

    <% if notice %>
      <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mx-4 mt-4" role="alert">
        <%= notice %>
      </div>
    <% end %>

    <% if alert %>
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mx-4 mt-4" role="alert">
        <%= alert %>
      </div>
    <% end %>

    <main class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
      <%= yield %>
    </main>

    <footer class="bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 mt-12 transition-colors duration-200">
      <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
        <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
          <div class="text-center md:text-left">
            <p class="text-sm text-gray-600 dark:text-gray-400">Made with ❤️</p>
            <p class="text-sm text-gray-600 dark:text-gray-400">
              <%= link_to "Designed, created, and property of No iLLusion Software", 
                          "https://no-illusion.com", 
                          class: "text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 underline" %>
            </p>
          </div>
          <div class="flex space-x-6">
            <%= link_to "Privacy Policy", privacy_path, class: "text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white" %>
            <%= link_to "Terms of Service", terms_path, class: "text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white" %>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>
